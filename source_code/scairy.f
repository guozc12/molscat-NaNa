      SUBROUTINE SCAIRY(Z, SCAI, SCBI, SCAIP, SCBIP, ZETA)
C  This subroutine is part of the MOLSCAT, BOUND and FIELD suite of programs
C
C  SCALED AIRY FUNCTIONS AND DERIVATIVES
C  THIS PROGRAM WRITTEN BY D.E. MANOLOPOULOS (SEPT. 1986)
C  CURRENT REVISION DATE: SEPT-1986
C  ----------------------------------------------------------------
C  FOR  Z .LT. (-5.0D0)
C  AI(Z) = SCAI*COS(ZETA) + SCBI*SIN(ZETA)
C  BI(Z) = SCBI*COS(ZETA) - SCAI*SIN(ZETA)
C  AI'(Z) = SCAIP*COS(ZETA) + SCBIP*SIN(ZETA)
C  BI'(Z) = SCBIP*COS(ZETA) - SCAIP*SIN(ZETA)
C  WHERE ZETA = (2/3)*(-Z)**(3/2) + PI/4
C
C  FOR (-5.0D0) .LE. Z .LE. (+0.0D0)
C  AI(Z) = SCAI
C  BI(Z) = SCBI
C  AI'(Z) = SCAIP
C  BI'(Z) = SCBIP
C  AND ZETA = 0
C
C  FOR (+0.0D0) .LT. Z
C  AI(Z) = SCAI*EXP(-ZETA)
C  BI(Z) = SCBI*EXP(+ZETA)
C  AI'(Z) = SCAIP*EXP(-ZETA)
C  BI'(Z) = SCBIP*EXP(+ZETA)
C  WHERE ZETA = (2/3)*(+Z)**(3/2)
C  ----------------------------------------------------------------
C  EVALUATION OF THE FUNCTIONS IS BASED ON A NUMBER OF
C  CHEBYSHEV EXPANSIONS
C
C  THIS VERSION IS SUITABLE FOR MACHINES WITH FULL WORD PRECISION
C  ----------------------------------------------------------------
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      DOUBLE PRECISION A, B, C, C1, C2, DF, DG, EX, EXP1Z, EXP2Z, F,
     :                 G, PIB4, ROOT4Z, ROOTZ, RT3, SCAI, SCAIP, SCBI,
     :                 SCBIP, T, T2, XEPS, Y, Z, ZCUBE, ZETA, ZSQ
      DATA C1   / 3.55028053887817239D-01 /
      DATA C2   / 2.58819403792806798D-01 /
      DATA RT3  / 1.73205080756887729D+00 /
      DATA PIB4 / 7.85398163397448310D-01 /
      ZETA = 0.0D0
      XEPS = 0.0D0
C ----------------------------------------------------------------------
C  HERE IF NEAR ENOUGH ORIGIN TO USE 3 TERM POWER SERIES
      IF (ABS(Z).LE.0.025D0) THEN
        ZSQ = Z * Z
        ZCUBE = ZSQ * Z
C  EVALUATE POWER SERIES (THREE TERMS IS SUFFICIENT FOR ABS(X) < 0.025)
        DF = 1.D0 + ZCUBE / 6.D0 + ZCUBE * ZCUBE / 180.D0
        DG = Z * (1.D0 + ZCUBE / 12.D0 + ZCUBE * ZCUBE / 504.D0)
        SCAI = C1 * DF - C2 * DG
        SCBI = RT3 * (C1 * DF + C2 * DG)
C  NOW FOR DERIVATIVES
        DF = ZSQ / 2.D0 + ZSQ * ZCUBE / 30.D0
        DG = 1.D0 + ZCUBE / 3.D0 + ZCUBE * ZCUBE / 72.D0
        SCAIP = C1 * DF - C2 * DG
        SCBIP = RT3 * (C1 * DF + C2 * DG)
C  SCALE THE FUNCTIONS BY EXP(ZETA) IF Z .GT. 0
        IF (Z.GT.0.D0) THEN
          ROOTZ = SQRT(Z)
          ZETA = 2.0D0 * Z * ROOTZ / 3.0D0
          EX = EXP(ZETA)
          SCAI = SCAI * EX
          SCAIP = SCAIP * EX
          SCBI = SCBI / EX
          SCBIP = SCBIP / EX
        ENDIF
        RETURN
      ENDIF

      IF (Z.LT.(+9.0D0)) GOTO 10

C  HERE IF Z >= 9
      ROOTZ = SQRT(Z)
      ROOT4Z = SQRT(ROOTZ)
      ZETA = 2.0D0*Z*ROOTZ/3.0D0
      T = 36.0D0/ZETA - 1.0D0
      Y = ((((((((( +1.16537795324979200D-15*T
     *  -1.16414171455572480D-14)*T +1.25420655508401920D-13)*T
     *  -1.55860414100340659D-12)*T +2.21045776110011276D-11)*T
     *  -3.67472827517194031D-10)*T +7.44830865396606612D-09)*T
     *  -1.95743559326380581D-07)*T +7.44672431969805149D-06)*T
     *  -5.28651881409929932D-04)*T +2.81558489585006298D-01
      SCAI = Y/ROOT4Z
      Y = ((((((((((( +4.50165999254528000D-15*T
     *  +1.56232018374502400D-14)*T +5.26240712559918080D-14)*T
     *  +2.97814898856618752D-13)*T +1.97577620975625677D-12)*T
     *  +1.53678944110742706D-11)*T +1.45409933537455235D-10)*T
     *  +1.71547326972380087D-09)*T +2.61898617129147064D-08)*T
     *  +5.49497993491833009D-07)*T +1.76719804365109334D-05)*T
     *  +1.12212109935874117D-03)*T +5.65294557558522063D-01
      SCBI = Y/ROOT4Z
      Y = ((((((((( +1.20954638924697600D-15*T
     *  -1.21281218539020800D-14)*T +1.31303723724964224D-13)*T
     *  -1.64152781754533677D-12)*T +2.34672185025709461D-11)*T
     *  -3.94507329122119338D-10)*T +8.13125005420910243D-09)*T
     *  -2.19736365932356533D-07)*T +8.83993515227257822D-06)*T
     *  -7.43456339972080231D-04)*T -2.82847316336379200D-01
      SCAIP = Y*ROOT4Z
      Y = ((((((((((( -4.59170437029478400D-15*T
     *  -1.59840960512122880D-14)*T -5.41258863340784640D-14)*T
     *  -3.07414589507261184D-13)*T -2.04866616770522650D-12)*T
     *  -1.60321415915690897D-11)*T -1.52922073861488292D-10)*T
     *  -1.82445639488695332D-09)*T -2.83250890588806503D-08)*T
     *  -6.11130377639012647D-07)*T -2.07842147963678572D-05)*T
     *  -1.56350017663858255D-03)*T +5.62646283094843014D-01
      SCBIP = Y*ROOT4Z
      RETURN

  10  IF (Z.LT.(+4.5D0)) GOTO 20

C  HERE IF 4.5 <=  Z < 9
      ROOTZ = SQRT(Z)
      ZETA = 2.0D0*Z*ROOTZ/3.0D0
      EXP1Z = EXP(ZETA-2.5D0*Z)
      EXP2Z = EXP(ZETA-2.625D0*Z)
      T = 4.0D0*Z/9.0D0 - 3.0D0
      Y = ((((((((((((((((((((( +9.69081960415394529D-11*T
     *  +3.24436136050920784D-10)*T -3.57419513430644674D-09)*T
     *  -3.84461320827974687D-09)*T +8.88116699085949212D-08)*T
     *  -6.26105174374717557D-08)*T -1.69051051004298110D-06)*T
     *  +3.80731416363041759D-06)*T +2.43840529113057777D-05)*T
     *  -9.74379632673654766D-05)*T -2.45324254437931970D-04)*T
     *  +1.69517926953312785D-03)*T +1.19638433540225211D-03)*T
     *  -2.15255594590357451D-02)*T +9.33777073522844198D-03)*T
     *  +1.98716159257796883D-01)*T -2.54001858882057718D-01)*T
     *  -1.27148775197878180D+00)*T +2.52046376168394778D+00)*T
     *  +5.04987271423387057D+00)*T -1.33120978544419281D+01)*T
     *  -9.34903846550381088D+00)*T +3.10330812950257837D+01
      SCAI = Y*EXP1Z
      Y = (((((((((((((((((((((((( +3.79210935744593920D-14*T
     *  -4.16346635040194560D-14)*T -3.63110681886588928D-13)*T
     *  +1.38932592029414195D-12)*T -4.00489068810888806D-12)*T
     *  +1.39019501834951721D-11)*T -4.50877182237241508D-11)*T
     *  +1.38942309844733264D-10)*T -3.92503498108710093D-10)*T
     *  +1.20125005161756928D-09)*T -3.14234550677825531D-09)*T
     *  +1.03100587323694771D-08)*T -2.35240060783126760D-08)*T
     *  +8.98525670958611253D-08)*T -1.57273011181242048D-07)*T
     *  +7.77696763289738864D-07)*T -8.40211181188135235D-07)*T
     *  +6.34887361301864569D-06)*T -2.73464023289055762D-06)*T
     *  +4.54606729925166230D-05)*T +2.20459155042947089D-06)*T
     *  +2.58823388957588056D-04)*T +7.31023768389466446D-05)*T
     *  +1.01013806904596356D-03)*T +2.64794416332118755D-04)*T
     *  +1.97499785553709145D-03
      SCBI = Y/EXP1Z
      Y = ((((((((((((((((((((( -4.40679918437492851D-10*T
     *  +1.30954945449348301D-10)*T +1.30052079376596751D-08)*T
     *  -2.21315827945437064D-08)*T -2.56850909380644963D-07)*T
     *  +8.66960855365698346D-07)*T +3.75622307499741911D-06)*T
     *  -2.15396233361107222D-05)*T -3.55804094667597110D-05)*T
     *  +3.95317852914037711D-04)*T +5.03369361986934094D-05)*T
     *  -5.54634417403436820D-03)*T +5.29658186908372832D-03)*T
     *  +5.91311623537658225D-02)*T -1.09446664596286554D-01)*T
     *  -4.63589435529194219D-01)*T +1.25323269822030972D+00)*T
     *  +2.50138108959469254D+00)*T -9.12668774193995449D+00)*T
     *  -8.14385732036876466D+00)*T +4.00134082550833019D+01)*T
     *  +1.15396202931444799D+01)*T -8.17378314444550419D+01
      SCAIP = Y*EXP1Z
      Y = (((((((((((((((((((((((( -1.12976379481423872D-13*T
     *  +2.84163275199873024D-13)*T +9.21367859618119680D-14)*T
     *  -6.47465116933029888D-13)*T +5.66210442158931968D-13)*T
     *  -3.03158042458901709D-12)*T +1.32640217809876419D-11)*T
     *  -3.03558223041639219D-11)*T +5.32290407073565901D-11)*T
     *  +1.67561690905544950D-11)*T -3.35234276365918044D-10)*T
     *  +2.92807773020050397D-09)*T -8.76900994127464369D-09)*T
     *  +4.69138029321003869D-08)*T -1.00929917942876779D-07)*T
     *  +5.40401934648687824D-07)*T -8.19977129258456927D-07)*T
     *  +5.13367651438974580D-06)*T -4.77800617725922708D-06)*T
     *  +4.02415391117897098D-05)*T -1.74571192912274417D-05)*T
     *  +2.45332091645215217D-04)*T -2.22916383050374016D-05)*T
     *  +1.02535993549737948D-03)*T +5.94033287658300975D-05)*T
     *  +2.17420627539345627D-03
      SCBIP = Y/EXP2Z
      RETURN

  20  IF (Z.LE.(+0.0D0)) GOTO 40

C  HERE IF 0.025 < Z < 4.5
      ROOTZ = SQRT(Z)
      ZETA = 2.0D0*Z*ROOTZ/3.0D0
      EXP1Z = EXP(ZETA-1.5D0*Z)
      EXP2Z = EXP(ZETA-1.375D0*Z)
      T = 4.0D0*Z/9.0D0 - 1.0D0

      IF (Z.LT.(+XEPS)) GOTO 30

      Y = ((((((((((((((((((((((( +4.97635854909020570D-12*T
     *  -3.25024150273916928D-11)*T -5.15773946723072737D-11)*T
     *  +8.66802872160017711D-10)*T -9.51292671519803048D-10)*T
     *  -1.33268133924677102D-08)*T +4.37061406144179625D-08)*T
     *  +1.18943714086308365D-07)*T -8.66980482244589319D-07)*T
     *  -2.46768077494905499D-08)*T +1.10610939830483627D-05)*T
     *  -1.80475663535516462D-05)*T -9.22213518989192294D-05)*T
     *  +3.15767712665407001D-04)*T +4.08626419412850994D-04)*T
     *  -3.12704269924340764D-03)*T +6.27899244118607949D-04)*T
     *  +1.99062142478229001D-02)*T -2.27427058211322122D-02)*T
     *  -7.94869698136278246D-02)*T +1.54261999158247445D-01)*T
     *  +1.75618463128730757D-01)*T -5.05223670654169859D-01)*T
     *  -1.49695902416050331D-01)*T +6.91290454439828966D-01
      SCAI = Y*EXP1Z
      Y = (((((((((((((((((((((((((((-8.01144609907912212D-11*T
     *  +2.67566208080291037D-10)*T +1.74416971406971503D-10)*T
     *  -3.12642164666800066D-09)*T +1.22114569059570056D-08)*T
     *  -2.93647730218878800D-08)*T +1.76951994785830839D-08)*T
     *  +2.13143266932123830D-07)*T -1.15569603602267288D-06)*T
     *  +3.34394065752949896D-06)*T -5.20143492253259528D-06)*T
     *  -3.21937890029830155D-06)*T +5.00360593064643409D-05)*T
     *  -1.77449408434194908D-04)*T +3.86357389967150628D-04)*T
     *  -4.53337922165622921D-04)*T -2.60866378774883161D-04)*T
     *  +3.01355585350049504D-03)*T -8.39047077309199055D-03)*T
     *  +1.63240267627966090D-02)*T -1.90830727084112485D-02)*T
     *  +1.65592661387959142D-02)*T +1.76101803014184860D-02)*T
     *  -3.36652019472526494D-02)*T +1.23831258886916327D-01)*T
     *  -6.48342330363017516D-02)*T +2.20310550882807725D-01)*T
     *  -1.03883014957365224D-02)*T +2.06857611342460346D-01
      SCBI = Y/EXP2Z

  30  Y = ((((((((((((((((((((((( -2.31635825886515692D-11*T
     *  +8.43840142802870600D-11)*T +3.68028065271203758D-10)*T
     *  -2.61043232825754937D-09)*T -4.65110871930215858D-10)*T
     *  +4.46164842334855713D-08)*T -9.24599436690579710D-08)*T
     *  -4.55809882095931368D-07)*T +2.21024501804834447D-06)*T
     *  +1.50251398952558802D-06)*T -2.91830008657289876D-05)*T
     *  +3.51391100964982453D-05)*T +2.37966767002002741D-04)*T
     *  -7.00969870295148024D-04)*T -9.84923358717942729D-04)*T
     *  +6.68935321740601810D-03)*T -1.66398286740112083D-03)*T
     *  -3.83618654865390504D-02)*T +4.80463615092658847D-02)*T
     *  +1.28359791076466449D-01)*T -2.80267155846714091D-01)*T
     *  -2.06049815358004057D-01)*T +7.63522843530878467D-01)*T
     *  +6.47699892977822355D-02)*T -8.32940737409625965D-01
      SCAIP = Y*EXP2Z
      Y = (((((((((((((((((((((((((((+2.69330665471830131D-10*T
     *  -1.25313111217921013D-09)*T +1.45057587508619405D-09)*T
     *  +5.82827351134571594D-09)*T -3.96093412314305685D-08)*T
     *  +1.37346521367521144D-07)*T -2.78927594518121271D-07)*T
     *  +2.96531845420687661D-08)*T +2.27734981888044076D-06)*T
     *  -1.02295902888535994D-05)*T +2.65515218319523965D-05)*T
     *  -3.86457370206378782D-05)*T -1.52212232476268640D-05)*T
     *  +2.84765225803690646D-04)*T -9.65798046252914453D-04)*T
     *  +2.04618065580453522D-03)*T -2.68702422147972510D-03)*T
     *  +8.36839039610090712D-04)*T +6.87131161447866570D-03)*T
     *  -2.10563741100004648D-02)*T +4.13290131622517073D-02)*T
     *  -5.03310394511775398D-02)*T +5.95467795825179773D-02)*T
     *  -1.64213101223235839D-02)*T +5.02536006477020710D-02)*T
     *  +5.75601787687195966D-02)*T +1.33220031651076020D-01)*T
     *  +7.76356357899154668D-02)*T +2.11213324176049168D-01
      SCBIP = Y/EXP1Z
      RETURN

  40  IF (Z.LT.(-5.0D0)) GOTO 60

C  HERE IF -5 <= Z < -0.025
      T = Z/5.0D0
      T = -T*T*T
      T = 2.0D0*T - 1.0D0
      T2 = 2.0D0*T

      IF (Z.GT.(-XEPS)) GOTO 50

      A = +1.63586492025000000D-18
      B = T2*A -1.14937368283025000D-16
      C = T2*B-A +7.06090635856696000D-15
      A = T2*C-B -3.75504581033290114D-13
      B = T2*A-C +1.70874975807662448D-11
      C = T2*B-A -6.56273599013291800D-10
      A = T2*C-B +2.09250023300659871D-08
      B = T2*A-C -5.42780372893997236D-07
      C = T2*B-A +1.11655763472468469D-05
      A = T2*C-B -1.76193215080912647D-04
      B = T2*A-C +2.03792657403144947D-03
      C = T2*B-A -1.61616260941907957D-02
      A = T2*C-B +7.87369695059018748D-02
      B = T2*A-C -1.88090320218915726D-01
      C = T2*B-A +8.83593328666433903D-02
      A = T2*C-B +9.46330439565858235D-02
      F = T*A-C +7.60869994141726643D-02
      A = +1.23340698467000000D-19
      B = T2*A -9.05440546731800000D-18
      C = T2*B-A +5.83052348377146000D-16
      A = T2*C-B -3.26253073273305810D-14
      B = T2*A-C +1.56911825099665634D-12
      C = T2*B-A -6.40386375393414830D-11
      A = T2*C-B +2.18414557202733054D-09
      B = T2*A-C -6.11127835033401880D-08
      C = T2*B-A +1.37095478225289560D-06
      A = T2*C-B -2.39464595313812449D-05
      B = T2*A-C +3.13306256975299299D-04
      C = T2*B-A -2.90953380590207648D-03
      A = T2*C-B +1.76972907074092250D-02
      B = T2*A-C -6.17055677164122241D-02
      C = T2*B-A +9.52472833367213949D-02
      A = T2*C-B -4.32381694223484894D-02
      G = T*A-C +3.76828717701544063D-02
      SCAI = F - G*Z
      SCBI = RT3*(F + G*Z)

  50  A = -2.51308436743000000D-18
      B = T2*A +1.65543326242034000D-16
      C = T2*B-A -9.49237123028142500D-15
      A = T2*C-B +4.68795260455788096D-13
      B = T2*A-C -1.96942895842729954D-11
      C = T2*B-A +6.93493715818491929D-10
      A = T2*C-B -2.01076965264476206D-08
      B = T2*A-C +4.69655735896232104D-07
      C = T2*B-A -8.59527033121202608D-06
      A = T2*C-B +1.18871496270269531D-04
      B = T2*A-C -1.18244097697332692D-03
      C = T2*B-A +7.87645202148185146D-03
      A = T2*C-B -3.14174372672396468D-02
      B = T2*A-C +6.20464642445295805D-02
      C = T2*B-A -4.83824291776351778D-02
      F = T*C-B +2.64808460123486707D-02
      A = +5.89382778069400000D-18
      B = T2*A -4.04811810887971000D-16
      C = T2*B-A +2.42680453287673090D-14
      A = T2*C-B -1.25683910148099294D-12
      B = T2*A-C +5.55607745069567295D-11
      C = T2*B-A -2.06683376304577072D-09
      A = T2*C-B +6.35924425685425485D-08
      B = T2*A-C -1.58422527393619013D-06
      C = T2*B-A +3.11007119112993551D-05
      A = T2*C-B -4.64189437787271433D-04
      B = T2*A-C +5.00970025411579034D-03
      C = T2*B-A -3.62166342717373453D-02
      A = T2*C-B +1.53114671641953510D-01
      B = T2*A-C -2.69270807740667256D-01
      C = T2*B-A -9.61843661149152853D-02
      A = T2*C-B +2.07099372879297732D-01
      G = T*A-C +9.79943887874547828D-02
      SCAIP = Z*Z*F - G
      SCBIP = RT3*(Z*Z*F + G)
      RETURN

C  HERE IF Z <= -5
  60  ROOTZ = SQRT(-Z)
      ROOT4Z = -SQRT(ROOTZ)
      ZETA = 2.0D0*(-Z)*ROOTZ/3.0D0
      T = -250.0D0/(Z*Z*Z) - 1.0D0
      A = ((((((((((((( -4.50071772808806400D-15*T
     *  +1.11777933477806080D-14)*T -1.39959545848483840D-14)*T
     *  +4.93110187870320640D-14)*T -2.02193307034590720D-13)*T
     *  +7.53585452663569920D-13)*T -3.14632365928501299D-12)*T
     *  +1.52351450024952975D-11)*T -8.75801572233507014D-11)*T
     *  +6.27349413509555121D-10)*T -6.02183526555303242D-09)*T
     *  +8.70043536788235270D-08)*T -2.32935044050984079D-06)*T
     *  +1.83605337367638430D-04)*T -5.64003555099413391D-01
      SCBI = A/ROOT4Z
      B = (((((((((((((((( -4.12972759036723200D-15*T
     *  +8.36512465551360000D-15)*T -2.05945081774080000D-16)*T
     *  +6.23733840790323200D-15)*T -5.81333983959859200D-14)*T
     *  +1.52893566095288320D-13)*T -4.11064788026333184D-13)*T
     *  +1.33820884559538637D-12)*T -4.74293914921785574D-12)*T
     *  +1.84868021228605050D-11)*T -8.15686769476673166D-11)*T
     *  +4.19373390376196942D-10)*T -2.61584084406303574D-09)*T
     *  +2.10021454539364698D-08)*T -2.37847770210509358D-07)*T
     *  +4.43114636962516363D-06)*T -1.83241371436579068D-04)*T
     *  +3.89918976811026487D-02
      SCAI = (B/ZETA)/ROOT4Z
      A = ((((((((((((( -4.58484390222233600D-15*T
     *  +1.13969221615738880D-14)*T -1.43160328250060800D-14)*T
     *  +5.04734978526300160D-14)*T -2.07055957015081472D-13)*T
     *  +7.73043520694004480D-13)*T -3.23454581960357018D-12)*T
     *  +1.57043540332660220D-11)*T -9.06023827679991573D-11)*T
     *  +6.52303613917050367D-10)*T -6.30993998756281944D-09)*T
     *  +9.23711460831703303D-08)*T -2.54030284953639173D-06)*T
     *  +2.17448385781448409D-04)*T +5.64409671680379110D-01
      SCAIP = A*ROOT4Z
      B = (((((((((((((((( +4.19612197958451200D-15*T
     *  -8.50454708509081600D-15)*T +2.31421341122560000D-16)*T
     *  -6.39683104557465600D-15)*T +5.92509321833062400D-14)*T
     *  -1.56008660983891968D-13)*T +4.20106807813331968D-13)*T
     *  -1.36926896339755520D-12)*T +4.86000800286762854D-12)*T
     *  -1.89780061819570625D-11)*T +8.39314701970122041D-11)*T
     *  -4.32843814802265754D-10)*T +2.71124934991469715D-09)*T
     *  -2.19026888712002973D-08)*T +2.50504395196083566D-07)*T
     *  -4.75245434337472120D-06)*T +2.05252791097940732D-04)*T
     *  -5.46414841607309762D-02
      SCBIP = (B/ZETA)*ROOT4Z
      ZETA = ZETA + PIB4
      RETURN
      END
